name: Check version

on:
  pull_request:
    branches: [ main ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
<<<<<<< Updated upstream
      - name: Checkout
        uses: actions/checkout@v2

      - name: Check if version was incremented
        id: check_version
        run: |
          git fetch origin ${{ github.base_ref }}:$GITHUB_SHA
          CHANGED_FILES=$(git diff --name-only $GITHUB_SHA ${{ github.sha }})
=======
    - uses: actions/checkout@v2
>>>>>>> Stashed changes

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.x'

    - name: Install Python dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pyyaml

<<<<<<< Updated upstream
          if [[ -z "$VERSION_NUMBER" ]]; then
            echo "::error::Version number not found in <your_yaml_file>.yaml"
            exit 1
          fi

          VERSION_LINE=$(grep -n "## \[$VERSION_NUMBER\]" CHANGELOG.md | cut -d ':' -f 1)

          if [[ -z "$VERSION_LINE" ]]; then
            echo "::error::$VERSION_NUMBER entry not found in CHANGELOG.md"
            exit 1
          fi

          CHANGELOG_ENTRY=$(echo "$CHANGELOG_DIFF" | grep -A1 -e "## \[$VERSION_NUMBER\]" | grep -v "## \[$VERSION_NUMBER\]")
          if [[ -z "$CHANGELOG_ENTRY" ]]; then
            echo "::error::$VERSION_NUMBER entry missing details in CHANGELOG.md"
            exit 1
          fi
=======
    - name: Check version
      run: |
        python .github/workflows/check_version.py
>>>>>>> Stashed changes
